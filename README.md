# Account Rotator

Плагин для автоматической ротации аккаунтов бота в BlockMine.

## Описание

Плагин автоматически меняет username и password бота для обхода ограничений серверов. Поддерживает два режима работы: смену при запуске бота или по таймеру.

## Как работает

1. Вы добавляете список аккаунтов в формате `username:password`
2. Плагин определяет текущий username бота и находит его позицию в списке
3. Выбирает следующий аккаунт (по порядку или случайно)
4. Использует API `bot.api.changeCredentials()` для смены credentials
5. Бот автоматически перезапускается с новым аккаунтом
6. Время последней ротации сохраняется в БД

### Защита от бесконечного цикла

При режиме "При каждом запуске бота" плагин проверяет, не была ли ротация выполнена менее **10 секунд назад**. Это предотвращает бесконечный цикл перезапусков.

При ошибке смены аккаунта (например, username занят) плагин автоматически пытается использовать следующий аккаунт из списка.

## Настройки

### Режим ротации
- **При каждом запуске бота** - меняет аккаунт каждый раз при старте бота
- **Каждые N минут** - автоматически меняет аккаунт через заданный интервал

### Интервал (минуты)
Как часто менять аккаунт. Работает только в режиме "Каждые N минут".

**По умолчанию:** 30 минут

### Список аккаунтов
Массив строк в формате `username:password`

**Пример:**
```
bot1:password123
bot2:mypass456
bot3:secure789
```

### Порядок смены
- **По порядку (sequential)** - первый → второй → третий → снова первый
  - При запуске плагин определяет текущий username бота и берёт следующий из списка
  - Если текущий username не найден в списке, начинает с первого
- **Случайный (random)** - каждый раз выбирается случайный аккаунт

**Важно:** Плагин автоматически пропускает текущий аккаунт, чтобы не делать бесполезную смену на тот же username.

## Примеры использования

### Пример 1: Ротация каждые 30 минут по порядку
```json
{
  "mode": "interval",
  "interval": 30,
  "accounts": [
    "account1:pass1",
    "account2:pass2",
    "account3:pass3"
  ],
  "order": "sequential"
}
```

**Результат:** Бот будет переключаться между аккаунтами каждые 30 минут: account1 → account2 → account3 → account1...

### Пример 2: Случайная смена при каждом запуске
```json
{
  "mode": "startup",
  "accounts": [
    "bot_alpha:password1",
    "bot_beta:password2",
    "bot_gamma:password3"
  ],
  "order": "random"
}
```

**Результат:** При каждом запуске бота будет выбран случайный аккаунт из списка.

### Пример 3: Быстрая ротация каждые 5 минут
```json
{
  "mode": "interval",
  "interval": 5,
  "accounts": [
    "temp1:12345",
    "temp2:67890",
    "temp3:abcde"
  ],
  "order": "sequential"
}
```

**Результат:** Аккаунты меняются быстро, каждые 5 минут по очереди.

## Обработка ошибок

Если при смене аккаунта возникает ошибка (например, username уже занят другим ботом), плагин:
1. Логирует ошибку в консоль бота
2. Автоматически пытается использовать следующий аккаунт из списка
3. Повторяет попытки для всех аккаунтов в списке
4. Если все аккаунты не подошли - сообщает об этом в логах

## Требования

- BlockMine с поддержкой `bot.api.changeCredentials()` (версия с реализованным API смены credentials) коммит от 22.12.2025
- Минимум 2 аккаунта в списке для ротации

## Безопасность

⚠️ **Внимание:** Пароли хранятся в открытом виде в настройках плагина. Убедитесь, что доступ к панели управления ботом защищён.
